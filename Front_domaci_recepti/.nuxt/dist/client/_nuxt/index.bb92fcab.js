import{a as h}from"./axios.4d564c32.js";import{a as y}from"./accountStore.3470eac0.js";import{_ as V,n as u,c as m,b as i,w as c,a as v,q as p,F as _,o as d,d as l,s as I,t as A}from"./entry.d256b9ad.js";const w={data(){return{vrstaKorisnika:"",korisnici:[],korisnickoIme:"",headers:[{text:"Id",value:"Id"},{text:"Ime",value:"Ime"},{text:"Datum",value:"Datum"},{text:"Akcija",value:"action",sortable:!1}],loading:!1,page:1,nextPageAvailable:!1,snackbar:!1,snackbarMessage:"",snackbarColor:"",timeout:3e3}},watch:{vrstaKorisnika(){this.page=1,this.fetchKorisnici()}},methods:{goToRecepti(n){this.$router.push({path:"/admin/recepti"}),y.actions.setKorinsikId(n.Id)},async demote(n){var s,t;try{const o=document.cookie.replace(/(?:(?:^|.*;\s*)authToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),e=await h.post("http://127.0.0.1:8000/api/adminukloni",{korisnik_id:n},{headers:{Authorization:`Bearer ${o}`}});console.log(e.data),this.snackbarMessage="Korisniku uspješno skinuta uloga admina.",this.snackbarColor="success",this.snackbar=!0,this.fetchKorisnici()}catch(o){console.error(o),this.snackbarMessage=((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Došlo je do greške.",this.snackbarColor="error",this.snackbar=!0}},async izbrisi(n){var s,t;try{const o=document.cookie.replace(/(?:(?:^|.*;\s*)authToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),e=await h.post("http://127.0.0.1:8000/api/delkorisnik",{korisnik_id:n},{headers:{Authorization:`Bearer ${o}`}});console.log(e.data),this.snackbarMessage="Korisnik uspješno izbrisan.",this.snackbarColor="success",this.snackbar=!0,this.fetchKorisnici()}catch(o){console.error(o),this.snackbarMessage=((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Došlo je do greške.",this.snackbarColor="error",this.snackbar=!0}},async promoviraj(n){var s,t;try{const o=document.cookie.replace(/(?:(?:^|.*;\s*)authToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),e=await h.post("http://127.0.0.1:8000/api/adminuloge",{korisnik_id:n},{headers:{Authorization:`Bearer ${o}`}});console.log(e.data),this.snackbarMessage="Korisnik uspješno promoviran.",this.snackbarColor="success",this.snackbar=!0,this.fetchKorisnici()}catch(o){console.error(o),this.snackbarMessage=((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Došlo je do greške.",this.snackbarColor="error",this.snackbar=!0}},async fetchKorisnici(n){var o,e;this.loading=!0,this.page=Number(n),isNaN(this.page)&&(this.page=1);const s=document.cookie.replace(/(?:(?:^|.*;\s*)authToken\s*=\s*([^;]*).*$)|^.*$/,"$1");let t="";this.vrstaKorisnika==="Admin"?t="http://localhost:8000/api/korisniciadmin":t="http://localhost:8000/api/korisnici";try{const a=await h.get(t,{params:{page:this.page},headers:{Authorization:`Bearer ${s}`}});this.korisnici=a.data.data,this.nextPageAvailable=a.data.next_page_url!==null,this.loading=!1}catch(a){console.error(a),this.snackbarMessage=((e=(o=a.response)==null?void 0:o.data)==null?void 0:e.message)||"Došlo je do greške.",this.snackbarColor="error",this.snackbar=!0,this.loading=!1}},async pretraziKorisnika(){this.page=1,await this.fetchKorisnici()}},created(){this.fetchKorisnici()}},T={class:"form-group"},j={class:"pagination"};function z(n,s,t,o,e,a){const f=u("v-combobox"),C=u("v-text-field"),k=u("v-btn"),g=u("v-row"),x=u("v-data-table"),K=u("v-snackbar");return d(),m(_,null,[i(g,null,{default:c(()=>[v("div",T,[i(f,{class:"combobox",label:"Vrsta korisnika",modelValue:e.vrstaKorisnika,"onUpdate:modelValue":s[0]||(s[0]=r=>e.vrstaKorisnika=r),items:["Admin","Korisnik"],required:"",onChange:a.fetchKorisnici},null,8,["modelValue","onChange"]),i(g,null,{default:c(()=>[i(C,{modelValue:e.korisnickoIme,"onUpdate:modelValue":s[1]||(s[1]=r=>e.korisnickoIme=r),label:"Korisničko ime",required:""},null,8,["modelValue"]),i(k,{class:"btn",onClick:a.pretraziKorisnika},{default:c(()=>[l("Pretraži")]),_:1},8,["onClick"])]),_:1})])]),_:1}),i(x,{headers:e.headers,items:e.korisnici,class:"elevation-1",loading:e.loading},{"item.action":c(({item:r})=>[i(k,{class:"btn",style:{"background-color":"#FF6347","margin-right":"0.1rem"},onClick:b=>a.goToRecepti(r)},{default:c(()=>[l("Recepti")]),_:2},1032,["onClick"]),e.vrstaKorisnika!=="Admin"?(d(),m(_,{key:0},[i(k,{class:"btn",style:{margin:"0","margin-right":"0.1rem"},color:"primary",onClick:b=>a.promoviraj(r.Id)},{default:c(()=>[l("Promote")]),_:2},1032,["onClick"]),i(k,{class:"btn",style:{margin:"0"},color:"error",onClick:b=>a.izbrisi(r.Id)},{default:c(()=>[l("Izbriši")]),_:2},1032,["onClick"])],64)):p("",!0),e.vrstaKorisnika==="Admin"?(d(),I(k,{key:1,class:"btn",style:{"margin-right":"0.5rem"},color:"error",onClick:b=>a.demote(r.Id)},{default:c(()=>[l("Demote")]),_:2},1032,["onClick"])):p("",!0)]),_:1},8,["headers","items","loading"]),v("div",j,[e.page>1?(d(),m("button",{key:0,class:"pagination-button",onClick:s[2]||(s[2]=r=>a.fetchKorisnici(e.page-1))},"Previous")):p("",!0),e.nextPageAvailable?(d(),m("button",{key:1,class:"pagination-button",onClick:s[3]||(s[3]=r=>a.fetchKorisnici(e.page+1))},"Next")):p("",!0)]),i(K,{modelValue:e.snackbar,"onUpdate:modelValue":s[5]||(s[5]=r=>e.snackbar=r),timeout:e.timeout,color:e.snackbarColor,style:{bottom:"50px"}},{default:c(()=>[l(A(e.snackbarMessage)+" ",1),i(k,{color:"white",text:"",onClick:s[4]||(s[4]=r=>e.snackbar=!1),class:"snackbar-close-btn"},{default:c(()=>[l("Close")]),_:1})]),_:1},8,["modelValue","timeout","color"])],64)}const N=V(w,[["render",z]]);export{N as default};
