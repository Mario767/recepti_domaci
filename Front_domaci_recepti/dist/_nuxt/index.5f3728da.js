import{_ as f,n as g,c as n,a,x as c,y as m,q as h,b as k,v as b,o as p,p as x,e as z}from"./entry.c439460d.js";import{a as u}from"./axios.4d564c32.js";import{a as v}from"./accountStore.3470eac0.js";const I={data(){return{originalRecept:null,nazivRecepta:"",opis:"",slika:null,vrstaJela:null,slikaTooLarge:!1,slikaInvalidFormat:!1}},methods:{handleFileUpload(t){const e=t.target.files[0],i=5*1024*1024,d=["image/jpeg","image/png","image/webp"];if(e){if(e.size>i){this.slikaTooLarge=!0,this.slikaInvalidFormat=!1;return}if(!d.includes(e.type)){this.slikaInvalidFormat=!0,this.slikaTooLarge=!1;return}this.slikaTooLarge=!1,this.slikaInvalidFormat=!1,this.slika=e}},submitForm(){if(this.originalRecept.nazivRecepta===this.nazivRecepta&&this.originalRecept.opis===this.opis&&this.originalRecept.vrstaJela===this.vrstaJela&&!this.slika){this.$router.go(-1);return}const t=new FormData;t.append("recept_id",v.state.receptId),t.append("naziv_recepta",this.nazivRecepta),t.append("opis",this.opis),this.slika&&t.append("slika",this.slika),t.append("vrstajela",this.vrstaJela);const e=document.cookie.replace(/(?:(?:^|.*;\s*)authToken\s*=\s*([^;]*).*$)|^.*$/,"$1");u.post("http://localhost:8000/api/updaterec",t,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${e}`}}).then(()=>{this.$router.go(-1)}).catch(i=>{console.error("Došlo je do greške prilikom spremanja recepta:",i)})},getReceptData(t){u.get(`http://127.0.0.1:8000/api/dohvatirec/${t}`).then(e=>{this.originalRecept=e.data,this.nazivRecepta=e.data.naziv_recepta,this.opis=e.data.opis,this.vrstaJela=e.data.vrstajela}).catch(e=>{console.error("Došlo je do greške prilikom dohvaćanja recepta:",e)})}},created(){let t=v.state.receptId;typeof sessionStorage<"u"&&(t=t||sessionStorage.getItem("receptId")),this.getReceptData(t)}},l=t=>(x("data-v-e23555b8"),t=t(),z(),t),R={id:"app"},F=l(()=>a("h2",{class:"title"},"Uredi recept",-1)),y={class:"form-group"},j=l(()=>a("label",{for:"naziv_recepta"},"Naziv recepta:",-1)),S={class:"form-group"},T=l(()=>a("label",{for:"opis"},"Opis:",-1)),V={class:"form-group"},D=l(()=>a("label",{for:"slika"},"Slika:",-1)),J={key:0,class:"error-message"},U={key:1,class:"error-message"},w={class:"form-group"},L=["disabled"];function B(t,e,i,d,s,r){const _=g("v-combobox");return p(),n("div",R,[F,a("form",{onSubmit:e[4]||(e[4]=b((...o)=>r.submitForm&&r.submitForm(...o),["prevent"])),class:"form-container"},[a("div",y,[j,c(a("input",{type:"text",id:"naziv_recepta","onUpdate:modelValue":e[0]||(e[0]=o=>s.nazivRecepta=o),maxlength:"60",required:""},null,512),[[m,s.nazivRecepta]])]),a("div",S,[T,c(a("textarea",{id:"opis","onUpdate:modelValue":e[1]||(e[1]=o=>s.opis=o),maxlength:"1000",required:""},null,512),[[m,s.opis]])]),a("div",V,[D,a("input",{type:"file",id:"slika",onChange:e[2]||(e[2]=(...o)=>r.handleFileUpload&&r.handleFileUpload(...o)),accept:"image/*"},null,32),s.slikaTooLarge?(p(),n("span",J,"Slika je prevelika (max 5 MB)")):h("",!0),s.slikaInvalidFormat?(p(),n("span",U,"Neispravan format slike")):h("",!0)]),a("div",w,[k(_,{label:"Vrsta jela",modelValue:s.vrstaJela,"onUpdate:modelValue":e[3]||(e[3]=o=>s.vrstaJela=o),items:["Glavno jelo","Predjelo","Desert"],required:""},null,8,["modelValue"])]),a("button",{type:"submit",disabled:s.slikaTooLarge||s.slikaInvalidFormat},"Spremi recept",8,L)],32)])}const M=f(I,[["render",B],["__scopeId","data-v-e23555b8"]]);export{M as default};
