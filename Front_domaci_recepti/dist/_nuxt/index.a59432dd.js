import{a as m}from"./axios.4d564c32.js";import{a as y}from"./accountStore.3470eac0.js";import{_ as z,n as u,c as h,b as r,w as c,a as v,q as p,F as _,o as d,d as l,s as V,t as I}from"./entry.f05f5772.js";const A={data(){return{vrstaKorisnika:"",korisnici:[],korisnickoIme:"",headers:[{text:"Id",value:"Id"},{text:"Ime",value:"Ime"},{text:"Datum",value:"Datum"},{text:"Akcija",value:"action",sortable:!1}],loading:!1,page:1,nextPageAvailable:!1,snackbar:!1,snackbarMessage:"",snackbarColor:"",timeout:3e3}},watch:{vrstaKorisnika(){this.page=1,this.fetchKorisnici()}},methods:{goToRecepti(n){this.$router.push({path:"/admin/recepti"}),y.actions.setKorinsikId(n.Id)},async demote(n){var s,t;try{const o=document.cookie.replace(/(?:(?:^|.*;\s*)authToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),e=await m.post("http://pzi202024.studenti.sum.ba/backend/api/adminukloni",{korisnik_id:n},{headers:{Authorization:`Bearer ${o}`}});console.log(e.data),this.snackbarMessage="Korisniku uspješno skinuta uloga admina.",this.snackbarColor="success",this.snackbar=!0,this.fetchKorisnici()}catch(o){console.error(o),this.snackbarMessage=((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Došlo je do greške.",this.snackbarColor="error",this.snackbar=!0}},async izbrisi(n){var s,t;try{const o=document.cookie.replace(/(?:(?:^|.*;\s*)authToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),e=await m.post("http://pzi202024.studenti.sum.ba/backend/api/delkorisnik",{korisnik_id:n},{headers:{Authorization:`Bearer ${o}`}});console.log(e.data),this.snackbarMessage="Korisnik uspješno izbrisan.",this.snackbarColor="success",this.snackbar=!0,this.fetchKorisnici()}catch(o){console.error(o),this.snackbarMessage=((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Došlo je do greške.",this.snackbarColor="error",this.snackbar=!0}},async promoviraj(n){var s,t;try{const o=document.cookie.replace(/(?:(?:^|.*;\s*)authToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),e=await m.post("http://pzi202024.studenti.sum.ba/backend/api/adminuloge",{korisnik_id:n},{headers:{Authorization:`Bearer ${o}`}});console.log(e.data),this.snackbarMessage="Korisnik uspješno promoviran.",this.snackbarColor="success",this.snackbar=!0,this.fetchKorisnici()}catch(o){console.error(o),this.snackbarMessage=((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"Došlo je do greške.",this.snackbarColor="error",this.snackbar=!0}},async fetchKorisnici(n){var o,e;this.loading=!0,this.page=Number(n),isNaN(this.page)&&(this.page=1);const s=document.cookie.replace(/(?:(?:^|.*;\s*)authToken\s*=\s*([^;]*).*$)|^.*$/,"$1");let t="";this.vrstaKorisnika==="Admin"?t="http://pzi202024.studenti.sum.ba/backend/api/korisniciadmin":t="http://pzi202024.studenti.sum.ba/backend/api/korisnici";try{const a=await m.get(t,{params:{page:this.page},headers:{Authorization:`Bearer ${s}`}});this.korisnici=a.data.data,this.nextPageAvailable=a.data.next_page_url!==null,this.loading=!1}catch(a){console.error(a),this.snackbarMessage=((e=(o=a.response)==null?void 0:o.data)==null?void 0:e.message)||"Došlo je do greške.",this.snackbarColor="error",this.snackbar=!0,this.loading=!1}},async pretraziKorisnika(){this.page=1,await this.fetchKorisnici()}},created(){this.fetchKorisnici()}},w={class:"form-group"},T={class:"pagination"};function j(n,s,t,o,e,a){const f=u("v-combobox"),C=u("v-text-field"),k=u("v-btn"),g=u("v-row"),x=u("v-data-table"),K=u("v-snackbar");return d(),h(_,null,[r(g,null,{default:c(()=>[v("div",w,[r(f,{class:"combobox",label:"Vrsta korisnika",modelValue:e.vrstaKorisnika,"onUpdate:modelValue":s[0]||(s[0]=i=>e.vrstaKorisnika=i),items:["Admin","Korisnik"],required:"",onChange:a.fetchKorisnici},null,8,["modelValue","onChange"]),r(g,null,{default:c(()=>[r(C,{modelValue:e.korisnickoIme,"onUpdate:modelValue":s[1]||(s[1]=i=>e.korisnickoIme=i),label:"Korisničko ime",required:""},null,8,["modelValue"]),r(k,{class:"btn",onClick:a.pretraziKorisnika},{default:c(()=>[l("Pretraži")]),_:1},8,["onClick"])]),_:1})])]),_:1}),r(x,{headers:e.headers,items:e.korisnici,class:"elevation-1",loading:e.loading},{"item.action":c(({item:i})=>[r(k,{class:"btn",style:{"background-color":"#FF6347","margin-right":"0.1rem"},onClick:b=>a.goToRecepti(i)},{default:c(()=>[l("Recepti")]),_:2},1032,["onClick"]),e.vrstaKorisnika!=="Admin"?(d(),h(_,{key:0},[r(k,{class:"btn",style:{margin:"0","margin-right":"0.1rem"},color:"primary",onClick:b=>a.promoviraj(i.Id)},{default:c(()=>[l("Promote")]),_:2},1032,["onClick"]),r(k,{class:"btn",style:{margin:"0"},color:"error",onClick:b=>a.izbrisi(i.Id)},{default:c(()=>[l("Izbriši")]),_:2},1032,["onClick"])],64)):p("",!0),e.vrstaKorisnika==="Admin"?(d(),V(k,{key:1,class:"btn",style:{"margin-right":"0.5rem"},color:"error",onClick:b=>a.demote(i.Id)},{default:c(()=>[l("Demote")]),_:2},1032,["onClick"])):p("",!0)]),_:1},8,["headers","items","loading"]),v("div",T,[e.page>1?(d(),h("button",{key:0,class:"pagination-button",onClick:s[2]||(s[2]=i=>a.fetchKorisnici(e.page-1))},"Previous")):p("",!0),e.nextPageAvailable?(d(),h("button",{key:1,class:"pagination-button",onClick:s[3]||(s[3]=i=>a.fetchKorisnici(e.page+1))},"Next")):p("",!0)]),r(K,{modelValue:e.snackbar,"onUpdate:modelValue":s[5]||(s[5]=i=>e.snackbar=i),timeout:e.timeout,color:e.snackbarColor,style:{bottom:"50px"}},{default:c(()=>[l(I(e.snackbarMessage)+" ",1),r(k,{color:"white",text:"",onClick:s[4]||(s[4]=i=>e.snackbar=!1),class:"snackbar-close-btn"},{default:c(()=>[l("Close")]),_:1})]),_:1},8,["modelValue","timeout","color"])],64)}const N=z(A,[["render",j]]);export{N as default};
