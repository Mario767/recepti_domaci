import{C as D,D as E,r as i,o as s,c as l,a as t,x as k,y as m,t as v,q as d,B as L,p as K,e as R,_ as N}from"./entry.c439460d.js";import{a as w}from"./axios.4d564c32.js";const x=_=>(K("data-v-d3a2679e"),_=_(),R(),_),T={id:"app"},q={class:"login-container"},F=x(()=>t("h1",{class:"title"},"Domaći recepti",-1)),M={key:0},A={key:0,class:"error-message"},G={key:1,class:"error-message"},H={key:2,class:"error-message"},J={key:3,class:"error-message"},O={key:1},Q={key:0,class:"error-message"},W={key:1},X={key:2},Y={key:2},Z=x(()=>t("h2",null,"Uspješna registracija!",-1)),$=x(()=>t("p",null,"Bit ćete preusmjereni na stranicu za prijavu...",-1)),ee=[Z,$],oe={key:3,class:"error-message"},ae=D({__name:"index",setup(_){const U=E(),c=i(""),n=i(""),u=i(""),p=i(""),j=i(""),C=i(!1),b=i(""),f=i(!1),z=i(""),h=i(!1),g=i(""),o=i({korisnicko_ime:"",email:"",lozinka:"",potvrda_lozinke:"",confirmationCode:""});let y=null;const I=()=>{clearInterval(y);let e=180;y=setInterval(()=>{e>0?(e--,g.value=e):(clearInterval(y),g.value="")},1e3)},V=()=>{let e=!0;return c.value?c.value.length>40?(o.value.korisnicko_ime="Korisničko ime ne može biti duže od 40 znakova.",e=!1):o.value.korisnicko_ime="":(o.value.korisnicko_ime="Korisničko ime je obavezno.",e=!1),u.value?u.value.length>50?(o.value.email="Email ne može biti duži od 50 znakova.",e=!1):u.value.includes("@")?o.value.email="":(o.value.email="Email mora sadržavati @ znak.",e=!1):(o.value.email="Email je obavezan.",e=!1),n.value?n.value.length>50?(o.value.lozinka="Lozinka ne može biti duža od 50 znakova.",e=!1):n.value.length<6?(o.value.lozinka="Lozinka mora biti duža od 5 znakova.",e=!1):o.value.lozinka="":(o.value.lozinka="Lozinka je obavezna.",e=!1),p.value?p.value!==n.value?(o.value.potvrda_lozinke="Lozinke se moraju podudarati.",e=!1):o.value.potvrda_lozinke="":(o.value.potvrda_lozinke="Potvrda lozinke je obavezna.",e=!1),e},P=async()=>{if(V())try{const e=await w.post("http://localhost:8000/api/sendcode",{korisnicko_ime:c.value,email:u.value,lozinka:n.value,potvrda_lozinke:p.value});console.log(e),e.status===200&&(C.value=!0,I())}catch(e){if(e.response&&e.response.status===422){const{errors:a}=e.response.data;a.korisnicko_ime&&(o.value.korisnicko_ime=a.korisnicko_ime[0]),a.email&&(o.value.email=a.email[0]),a.lozinka&&(o.value.lozinka=a.lozinka[0]),a.potvrda_lozinke&&(o.value.potvrda_lozinke=a.potvrda_lozinke[0])}else b.value="Došlo je do greške. Pokušajte ponovno.";console.error(e)}},S=async()=>{try{const e=await w.post("http://localhost:8000/api/confirmcode",{confirmationCode:j.value,korisnicko_ime:c.value,lozinka:n.value,email:u.value});console.log(e),e.data.message==="Registracija uspješna!"?(f.value=!0,z.value="Registracija uspješna!",h.value=!0,clearInterval(y),setTimeout(()=>{U.push("/login")},2e3)):(o.value.confirmationCode=e.data.message,z.value=e.data.message,h.value=!0,setTimeout(()=>{h.value=!1},3e3))}catch(e){console.error(e),o.value.confirmationCode="Neispravan kod za potvrdu."}},B=async()=>{try{const e=await w.post("http://localhost:8000/api/sendcode",{korisnicko_ime:c.value,lozinka:n.value,email:u.value});console.log(e),e.status===200&&I()}catch(e){console.error(e)}};return(e,a)=>(s(),l("div",T,[t("div",q,[F,!C.value&&!f.value?(s(),l("div",M,[k(t("input",{class:"input-field",type:"text",placeholder:"Unesi korisničko ime","onUpdate:modelValue":a[0]||(a[0]=r=>c.value=r)},null,512),[[m,c.value]]),o.value.korisnicko_ime?(s(),l("p",A,v(o.value.korisnicko_ime),1)):d("",!0),k(t("input",{class:"input-field",type:"email",placeholder:"Unesi email","onUpdate:modelValue":a[1]||(a[1]=r=>u.value=r)},null,512),[[m,u.value]]),o.value.email?(s(),l("p",G,v(o.value.email),1)):d("",!0),k(t("input",{class:"input-field",type:"password",placeholder:"Unesi lozinku","onUpdate:modelValue":a[2]||(a[2]=r=>n.value=r)},null,512),[[m,n.value]]),o.value.lozinka?(s(),l("p",H,v(o.value.lozinka),1)):d("",!0),k(t("input",{class:"input-field",type:"password",placeholder:"Potvrdi lozinku","onUpdate:modelValue":a[3]||(a[3]=r=>p.value=r)},null,512),[[m,p.value]]),o.value.potvrda_lozinke?(s(),l("p",J,v(o.value.potvrda_lozinke),1)):d("",!0),t("button",{class:"register-button",onClick:P},"Registriraj se")])):C.value&&!f.value?(s(),l("div",O,[k(t("input",{class:"input-field",type:"text",placeholder:"Unesi kod za potvrdu","onUpdate:modelValue":a[4]||(a[4]=r=>j.value=r)},null,512),[[m,j.value]]),o.value.confirmationCode?(s(),l("p",Q,v(o.value.confirmationCode),1)):d("",!0),t("button",{class:"register-button",onClick:S},"Potvrdi kod"),t("button",{class:"register-button",onClick:B},"Ponovno pošalji kod"),g.value>0?(s(),l("p",W,"Kod ističe za: "+v(g.value)+" sekundi",1)):(s(),l("p",X,"Kod je istekao. Ponovno pošaljite kod za prijavu."))])):f.value?(s(),l("div",Y,ee)):d("",!0),b.value?(s(),l("p",oe,v(b.value),1)):d("",!0),z.value?(s(),l("div",{key:4,class:L({snackbar:!0,show:h.value})},v(z.value),3)):d("",!0)])]))}});const ie=N(ae,[["__scopeId","data-v-d3a2679e"]]);export{ie as default};
